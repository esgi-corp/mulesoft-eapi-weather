name: Deploy branch to Sandbox
run-name: Deploy branch ${{ github.event.inputs.branch }} to Sandbox

on:
  workflow_dispatch:
    inputs:
      branch:
        description: 'Nom de la branche à déployer'
        required: true
        default: 'main'
      jira_ticket:
        description: 'Jira ticket number'
        required: false
        default: ''

jobs:
  deploy_api:
    uses: esgi-corp/mulesoft_cicd/.github/workflows/api_deploy.yaml@main
    with:
      env: sandbox
      branch: ${{ github.event.inputs.branch }}
      jira_ticket: ${{ github.event.inputs.jira_ticket }}
      workers: ${{ vars.WORKERS }}
      vcores: ${{ vars.VCORES }} 
      app_name: "eapi-weather-app"
      repo_props_name: "mulesoft-eapi-weather-properties"
    secrets: inherit
